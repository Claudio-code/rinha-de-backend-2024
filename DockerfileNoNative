FROM amazoncorretto:21-alpine-jdk as builder

WORKDIR /builder

COPY . .

RUN ./gradlew build -x test

FROM amazoncorretto:21-alpine

COPY --from=builder /builder/build/libs/application.jar /app.jar

CMD ["java -server -Xms50m -Xmx100M -XX:MaxMetaspaceSize=256m -Xss516k -XX:+UseSerialGC -jar app.jar"]
